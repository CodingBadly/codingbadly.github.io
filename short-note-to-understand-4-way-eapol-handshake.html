<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Seyoung Jeong" />
        <meta name="copyright" content="Seyoung Jeong" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="WiFi, Eapol, 802.11i, WiFi, " />

<meta property="og:title" content="Short note to understand 4-way EAPOL handshake "/>
<meta property="og:url" content="http://codingbadly.github.io/short-note-to-understand-4-way-eapol-handshake.html" />
<meta property="og:description" content="" />
<meta property="og:site_name" content="Coding Badly" />
<meta property="og:article:author" content="Seyoung Jeong" />
<meta property="og:article:published_time" content="2017-05-17T00:00:00-07:00" />
<meta property="" content="2017-05-18T00:00:00-07:00" />
<meta name="twitter:title" content="Short note to understand 4-way EAPOL handshake ">
<meta name="twitter:description" content="">

        <title>Short note to understand 4-way EAPOL handshake  Â· Coding Badly
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://codingbadly.github.io/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://codingbadly.github.io/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://codingbadly.github.io/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://codingbadly.github.io/theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://codingbadly.github.io/"><span class=site-name>Coding Badly</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://codingbadly.github.io">Home</a></li>
                            <li ><a href="http://codingbadly.github.io/pages/about.html">About</a></li>
                            <li ><a href="http://codingbadly.github.io/categories.html">Categories</a></li>
                            <li ><a href="http://codingbadly.github.io/tags.html">Tags</a></li>
                            <li ><a href="http://codingbadly.github.io/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="http://codingbadly.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="http://codingbadly.github.io/short-note-to-understand-4-way-eapol-handshake.html"> Short note to understand 4-way EAPOL handshake  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <p>Both WPA/WPA2 personal and enterprise have the way to derive the source key - Pairwise Master Key or PMK. In case of WPA/WPA2 enterprise MSK(Master Session Key) is derived from EAP exchange and PSK is derived from MSK.<sup id="fnref:youtube"><a class="footnote-ref" href="#fn:youtube" rel="footnote">1</a></sup> </p>
<img alt="Sample sequence diagram" classes="uml" src="http://codingbadly.github.io/images/d41b8b08.png" /><ol>
<li>AP sends EAPOL-key which contans anonce (AP or Athenticator nonce), which is a random value that prevents replay attacks. At this point, the client can derive PSK from PMK, MAC address of the client and AP, and two nonces.</li>
<li>The cient sends a message that has snonce and MIC. The AP extracts the snonce and calculates PTK.</li>
<li>Keys are now in place on both sides, but needs to be confirmed. The AP sends the client a message indicating the pairwise key will be added. It also includes the current group transient key to enable udpate of the group key.</li>
<li>The client sends a final confirmation message to the AP.<sup id="fnref:book1"><a class="footnote-ref" href="#fn:book1" rel="footnote">2</a></sup></li>
</ol>
<p><br></p>
<blockquote>
<p>Glossary:</p>
<ul>
<li><em>ANonce</em> : AP nonce</li>
<li><em>EAP</em> : Extensible Authentication Protocol. A framework authentication protocol used by 802.1X to provide network authentication. Authentication itself is delegated to sub-protocols called methods</li>
<li><em>GTK</em> : Group Transient Key. Derived from the GMK by combining with the group random number, the GTK is used to derive the group key hierachy, which includes keys used to protect broadcast and multicast data.</li>
<li><em>MIC</em> : Message Integray Code. A hash value caluated over a set of protected data to guard against tampering. In most cryptographic systems, such a hash is called a Message Authentication Code (MAC). 802.11 uses the algorithm MIC to avoid confusion with the Medium Access Control layer.</li>
<li><em>PTK</em> : Pairwise Transient Key. Ke derived from PMK that includes keys used by encryption and integrity protocols, but also includes keys to distribute dynamic keys.</li>
<li><em>SNonce</em> : STA nonce</li>
</ul>
</blockquote>
<div class="footnote">
<hr />
<ol>
<li id="fn:youtube">
<p><a href="https://www.youtube.com/watch?v=9M8kVYFhMDw">The 4-way handshake on Youtube</a>&#160;<a class="footnote-backref" href="#fnref:youtube" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:book1">
<p><a href="https://www.amazon.com/802-11-Wireless-Networks-Definitive-Second/dp/0596100523">802.11 Wireless Networks The Definitive Guide</a>&#160;<a class="footnote-backref" href="#fnref:book1" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>
            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2017-05-17T00:00:00-07:00">May 17, 2017</time>

<h4>Last Updated</h4>
<time datetime="2017-05-18T00:00:00-07:00">May 18, 2017</time>

            <h4>Category</h4>
            <a class="category-link" href="http://codingbadly.github.io/categories.html#wifi-ref">WiFi</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="http://codingbadly.github.io/tags.html#80211i-ref">802.11i
                    <span>1</span>
</a></li>
                <li><a href="http://codingbadly.github.io/tags.html#eapol-ref">Eapol
                    <span>1</span>
</a></li>
                <li><a href="http://codingbadly.github.io/tags.html#wifi-ref">WiFi
                    <span>1</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="https://www.linkedin.com/in/seyoung/" title="My LinkedIn Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-linkedin sidebar-social-links"></i></a>
    <a href="#" title="My Another social link Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-another social link sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>