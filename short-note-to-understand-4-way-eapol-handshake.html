<!DOCTYPE html>
<html lang="en">
<head>
          <title>Coding Badly</title>
        <meta charset="utf-8" />



    <meta name="tags" content="WiFi" />
    <meta name="tags" content="Eapol" />
    <meta name="tags" content="802.11i" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://localhost:8000/">Coding Badly <strong></strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="http://localhost:8000/pages/about.html">About</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="http://localhost:8000/short-note-to-understand-4-way-eapol-handshake.html" rel="bookmark"
         title="Permalink to Short note to understand 4-way EAPOL handshake">Short note to understand 4-way EAPOL handshake</a></h2>
 
  </header>
  <footer class="post-info">
    <abbr class="published" title="2017-05-17T00:00:00-07:00">
      Wed 17 May 2017
    </abbr>
    <abbr class="modified" title="2017-05-20T00:00:00-07:00">
      Sat 20 May 2017
    </abbr>
    <address class="vcard author">
      By           <a class="url fn" href="http://localhost:8000/author/seyoung-jeong.html">Seyoung Jeong</a>
    </address>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>Both WPA/WPA2 personal and enterprise have the way to derive the source key - Pairwise Master Key or PMK. In case of WPA/WPA2 enterprise MSK(Master Session Key) is derived from EAP exchange and PSK is derived from MSK.<sup id="fnref:youtube"><a class="footnote-ref" href="#fn:youtube" rel="footnote">1</a></sup> </p>
<img alt="Sample sequence diagram" classes="uml" src="http://localhost:8000/images/d41b8b08.png" /><ol>
<li>AP sends EAPOL-key which contans anonce (AP or Athenticator nonce), which is a random value that prevents replay attacks. At this point, the client can derive PSK from PMK, MAC address of the client and AP, and two nonces.</li>
<li>The cient sends a message that has snonce and MIC. The AP extracts the snonce and calculates PTK.</li>
<li>Keys are now in place on both sides, but needs to be confirmed. The AP sends the client a message indicating the pairwise key will be added. It also includes the current group transient key to enable udpate of the group key.</li>
<li>The client sends a final confirmation message to the AP.<sup id="fnref:book1"><a class="footnote-ref" href="#fn:book1" rel="footnote">2</a></sup></li>
</ol>
<p><br></p>
<blockquote>
<p>Glossary:</p>
<ul>
<li><em>ANonce</em> : AP nonce</li>
<li><em>EAP</em> : Extensible Authentication Protocol. A framework authentication protocol used by 802.1X to provide network authentication. Authentication itself is delegated to sub-protocols called methods</li>
<li><em>GTK</em> : Group Transient Key. Derived from the GMK by combining with the group random number, the GTK is used to derive the group key hierachy, which includes keys used to protect broadcast and multicast data.</li>
<li><em>MIC</em> : Message Integray Code. A hash value caluated over a set of protected data to guard against tampering. In most cryptographic systems, such a hash is called a Message Authentication Code (MAC). 802.11 uses the algorithm MIC to avoid confusion with the Medium Access Control layer.</li>
<li><em>PTK</em> : Pairwise Transient Key. Ke derived from PMK that includes keys used by encryption and integrity protocols, but also includes keys to distribute dynamic keys.</li>
<li><em>SNonce</em> : STA nonce</li>
</ul>
</blockquote>
<div class="footnote">
<hr />
<ol>
<li id="fn:youtube">
<p><a href="https://www.youtube.com/watch?v=9M8kVYFhMDw">The 4-way handshake on Youtube</a>&#160;<a class="footnote-backref" href="#fnref:youtube" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:book1">
<p><a href="https://www.amazon.com/802-11-Wireless-Networks-Definitive-Second/dp/0596100523">802.11 Wireless Networks The Definitive Guide</a>&#160;<a class="footnote-backref" href="#fnref:book1" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>